<div class="row">
  <div class="col-xs-12">
    <h1 ng-bind="vm.title"></h1>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <button ng-if="vm.userCanAdd" class="btn btn-primary pull-right" ng-class="{'btn-default': !vm.project && !vm.program, 'btn-link': vm.project || vm.program}" ui-sref="opportunityadmin.create({programId:vm.programId, projectId:vm.projectId, programTitle:vm.programTitle, projectTitle:vm.projectTitle, context:vm.context})" title="New"><i class="fa fa-plus"></i> POST AN OPPORTUNITY
    </button>
  </div>
</div>

<div class="row">
  <div class="col-xs-12" ng-if="! vm.opportunities.length">
    <div class="well well-gray">
      <p>No open opportunities right now. Check back soon!</p>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">
    <div class="card card-flat" ng-class="{'card-greyed': !opportunity.isPublished}" ng-repeat="opportunity in vm.opportunities | slice:column.start:column.end">
      
      <div class="card-header" ng-if="vm.isAdmin || opportunity.userIs.admin" style="text-align: right">
          <span class="label label-danger" ng-if="!opportunity.isPublished"><i class="fa fa-exclamation-triangle" ></i> UNPUBLISHED</span>
          &nbsp;
          <span class="label label-primary">Admin</span>
          &nbsp;
          <a ng-if="opportunity.project.isPublished && (vm.isAdmin || opportunity.userIs.admin) && opportunity.isPublished" href="javascript:void(0);" ng-click="vm.publish(opportunity, false); $event.stopPropagation()" uib-tooltip="Unpublish"><i class="glyphicon glyphicon-ban-circle"></i></a>
          &nbsp;
          <a ng-if="opportunity.project.isPublished && (vm.isAdmin || opportunity.userIs.admin) && !opportunity.isPublished" href="javascript:void(0);" ng-click="vm.publish(opportunity, true); $event.stopPropagation()" uib-tooltip="Publish"><i class="glyphicon glyphicon-check"></i>
          </a>
          &nbsp;
          <a ng-if="vm.isAdmin || opportunity.userIs.admin" href="javascript:void(0);"  id="opportunityadmin.edit" ui-sref="opportunityadmin.edit({ opportunityId: opportunity.code, projectId: vm.projectId })" ng-click="$event.stopPropagation()" uib-tooltip="Edit"><i class="glyphicon glyphicon-edit"></i></a>
         <button ng-if="vm.canApplyGeneral && !opportunity.userIs.member && !opportunity.userIs.request" class="btn btn-default btn-sm">Apply</button>
      </div>


      <div class="card-block" ng-class="{'cbg-light-grey-blue':(opportunity.opportunityTypeCd==='sprint-with-us')}" id="opportunities.view" ui-sref="opportunities.view({ opportunityId: opportunity.code, projectId: vm.projectId })">

        <div class="label-list">
            <label class="label label-price"><i class="fa fa-tag"></i>&nbsp;{{opportunity.earn|currency}}</label>
            <label class="label label-deadline"><i class="fa fa-hourglass-half"></i>&nbsp;<span class="light">Closing in:</span><span class="danger"> {{vm.closing(opportunity)}}</span></label>
            <label class="label label-danger" ng-if="opportunity.opportunityTypeCd==='sprint-with-us'"><i class="fa fa-users"></i> Team Required </label>
            <label class="label label-location"><i class="fa fa-map-marker fa-lg"></i>&nbsp;{{opportunity.location}} /
              <span ng-if="opportunity.onsite == 'offsite'">In-person work NOT required</span>
              <span ng-if="opportunity.onsite == 'onsite'">In-person work required</span>
              <span ng-if="opportunity.onsite == 'mixed'">Some in-person work required</span>  
            </label>
            <label class="label label-warning" ng-repeat="code in opportunity.skills">{{code}}</label>
        </div>

        <div class="card-title" ng-bind="opportunity.name"></div>
        <p ng-bind="opportunity.short"></p>

      </div>
    </div>
  </div>
</div>
